# Chat Algorithm Module

Algorithm module for the keyboard panel’s word-suggestion feature.

## File structure

```
Algorithm/
├── index.js              # Central export entry
├── word-completion.js    # Word completion (completes partially typed words)
├── word-prediction.js    # Next-word prediction
├── basic.html            # Simple test page for algorithms
├── Corpus/               # JS corpus used by the web app (generated by build from RawCSV)
│   ├── words.js
│   ├── bigrams.js
│   ├── trigrams.js
│   ├── 4grams.js
│   └── 5grams.js
├── RawCSV/               # Source CSV and build script
│   ├── 1grams_english.csv
│   ├── 2grams_english.csv
│   ├── 3grams_english.csv
│   ├── 4grams_english.csv
│   ├── 5grams_english.csv
│   └── build-ngrams.js   # Generates Corpus/*.js from CSV; run: node RawCSV/build-ngrams.js
└── README.md             # This file
```

## Usage

### Word completion

Completes the word the user is typing. Example: input `"hello wor"` → suggestions `"world"`, `"work"`, `"word"`, etc.

```javascript
import { completeWord } from "./Algorithm/index.js";

const suggestions = await completeWord("hello wor", 6);
// Returns: ["world", "work", "word", ...]
```

**Parameters:**
- `partialWord` (string): The partially typed word
- `maxSuggestions` (number, optional): Maximum number of suggestions, default 6

**Returns:**
- `Promise<string[]>`: Array of suggested words, sorted by frequency

### Word prediction

Predicts the next word after the user types one or more words and a space. Uses n-gram data (bigrams through 5-grams) and falls back to top 1-gram words.

- `predictNextWord(currentInput, maxSuggestions)` – async
- `predictNextWordSync(currentInput, maxSuggestions)` – sync
- `topFourWords` – default suggestions when input is empty (top 4 by frequency); used by the UI as fallback

## Data files

- **`Corpus/`**: JS files used by the web app (words.js, bigrams.js, etc.), generated from CSV by `RawCSV/build-ngrams.js`.
- **`RawCSV/`**: Source CSV files and the build script.

### When to run build-ngrams.js (manual, on demand)

Run it manually when you’ve updated CSV in RawCSV and want to refresh the corpus used by the web app. You can run it as many times as you like; each run regenerates and overwrites bigrams.js, trigrams.js, 4grams.js, and 5grams.js under `Corpus/`.

**Run it MANUALLY (after Raw change):**

1. **From the project root:**
   ```bash
   node src/Features/Chat/Algorithm/RawCSV/build-ngrams.js
   ```

2. **From the RawCSV directory:**
   ```bash
   cd src/Features/Chat/Algorithm/RawCSV
   node build-ngrams.js
   ```

## Notes

- All algorithms are exported through `index.js`.
- `basic.html` is a minimal test page for trying completion/prediction in the browser.
